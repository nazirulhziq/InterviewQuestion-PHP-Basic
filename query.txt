UPDATE employee_job_table SET job_id = 4, effective_date = 2020-01-01 
WHERE employee_no=1002;

SELECT  EMPLOYEE_PROFILE_TABLE.EMPLOYEE_NAME,EMPLOYEE_PROFILE_TABLE.EMPLOYEE_NO, EMPLOYEE_JOB_TABLE.EFFECTIVE_DATE, JOB_PROFILE_TABLE.JOB_NAME
 FROM EMPLOYEE_JOB_TABLE 
  INNER JOIN EMPLOYEE_PROFILE_TABLE ON EMPLOYEE_PROFILE_TABLE.EMPLOYEE_ID=EMPLOYEE_JOB_TABLE.EMPLOYEE_ID
 INNER JOIN JOB_PROFILE_TABLE ON JOB_PROFILE_TABLE.JOB_ID=EMPLOYEE_JOB_TABLE.JOB_ID;


SELECT st.EMPLOYEE_NAME, st.EMPLOYEE_NO, su.JOB_NAME
FROM EMPLOYEE_PROFILE_TABLE st
INNER JOIN EMPLOYEE_JOB_TABLE sc ON st.EMPLOYEE_ID = sc.EMPLOYEE_ID
INNER JOIN JOB_PROFILE_TABLE su ON sc.JOB_ID = su.JOB_ID
WHERE sc.EFFECTIVE_DATE = (SELECT MAX(sca.EFFECTIVE_DATE) 
                       FROM EMPLOYEE_JOB_TABLE sca 
                       WHERE sc.EMPLOYEE_ID = sca.EMPLOYEE_ID 
                       GROUP BY sca.EMPLOYEE_ID)
  

DELETE EMPLOYEE_JOB_TABLE
FROM EMPLOYEE_JOB_TABLE
INNER JOIN EMPLOYEE_PROFILE_TABLE ON EMPLOYEE_PROFILE_TABLE.EMPLOYEE_ID=EMPLOYEE_JOB_TABLE.EMPLOYEE_ID
WHERE EMPLOYEE_NO='1000' AND EFFECTIVE_DATE='01/01/2020';
